<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="WorkLog">
    
    <link rel="apple-touch-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAMlUlEQVR4nO2dX2xb133Hv+feX4oiKdlSZduSbCexE7uNnSR9SRtk87Y0D/3YQ7cg3d7aXnrru0G6vW7w0A0etg1YgX7oFmCB9rA+ZNuAYl2yE0Uf7G0NsmF9k2I5iS05kR1LsiVLliWRkvh779mDO3KUSOq/t5SSc3z/AEWR3HO+P/d77jm/cx4hBBAgQIAAAQIECCBEH6FqQd0sD759/vFhD2F/p252/vC3Pjh5Zc2zP+jBq2/i5w9f/tq8Z37wgz738LOn/7C9oN6e63G/f3T00Zdf+8P3L/gC+yI/f/hH/3bI4x6Z6zE/eP10z8g/fF8BQQgqgBAAQQQJAAQg+AEI637xN3/+5d/5z//5h3/0Nf0Nf3/8v/7h00eP7gH7pP7u6Ogz4w+PXnn99M32gno71+N++tEHJ6+053rcv891u69efu2Dk88+94d/8X3rB/bJ/eLw5a/Nu37w97n23I+OPvrJ66dvtufb353rcb/7sQICgEASIBEEIEAQQCIIQCBJEkACgBBBgCQABCBJAkggCQgQQYAkAASQSJIEkAggRBBAAkCIBCCABJCkIADJpCSBJAAEEJAAIoIEAJIAEkECSCQJIElBAImkJICkIEkASQAIIJGAABJJQEACSAQhAkkgKQhAAoIEkEiQpIAkkpIAEkECApICCCSQBAQkgEQQSAoQkgASQQICSCSRpABJCiKBBJIkkKSgIJAEkAggKQgQQYgkKSCBBCAgEaQAAUkKSCIpCBAkKYgQBIhEUhAgKQgQSZKCAAEiSCJBkoKABJBIkgIEKQgQJJIUQJICEkBSSAoCpCAAASRBkoKEoAAkCSQFIJJCgCAgIUAQkKSgpBAkBCSBBAkISAEICZICgKQAQQBCgqSAIEAASUIBkiAoQBIISYIACEKSEAQIApIIQoKgIAgISaKgIAhISaKCIBFSIkFSUFASKEhCQVAAQpIEQUFQkpQEQZAIKRMEBUFIUioIEoIkCJIqISVCIgiKJAkKkghCkiQISRIQBJIgIIkECcKkSCIpEiQpICVIglSCQApAioSkgECKAEmQBEkhIUlKkBCQApBCglRJSUIgKQhAkgQJSVIkCUhSgpASQRIISUJBkoJAEiQpEEiSICkISSIoCIkECUIqSVJKEEhKAEhKgCQIEoIEgSRISZCQAJIgSUJIEgRBgJRICKRISBIkpARIkiCBJEmQICkBCUFACiQJgpQkkJRAkCQpQQqCpAQJCUAqKQkkCUFKkECQBElSEhIEgRRICkISSIKkgpAkQZIEQSBBgpAUIEmSEpCgBIkEJYEECEFKCUhQElIqKEhJAEmClJAkKUkKJKlIkBCSJEEqQSoICVIgSUFAEpAUhJQSSFKCJEmCJEkISUoKQJICQQKSCgJCkgQIQZKAJElQkgQhSEJAkkiSICEIkkACJEASBCAIIElJQJJEEARICRIEpJSSAkGSJEkKkCQJgKRCkoQkkJKSoCAJCgICSZKkQEISgJIEAQiCIEmClIQUBIQUIAkBkJKQQJKkICSJJEVJgpAKAEgKEoKSBCVBgiSQpIAkAUGSBAlKkJQkKQlIQpKSlCAFIUmQBAGQlKSUgpQkKUlBCklKAEiCJAlKQgKkgJQgCQKCkgSQApCUBECSKpCSIEEAJAAkKQEpJSEIKZCSkAQBkqRQgiSFJEkQJIUgISkBSkFSChKSlIIUJEhJgKRAkEpSKgipkCQICkhSgpQESJIQKUhSgBCSBEEJSkEKBElBgpAkSUFIgISglIIUQJISBKlIUKogJQgqQQBBUgqSFAASBCgQQFKCkABJQZKkQEKSkkBKgiRFSkFASpCCkEpKAoKCEiQIEgSkJCGpFAhJQgqkpCCokgJBKUkIQpIUKUFIkiQBkgJKkiRJQpKUICEIUpJCkCBIgQBJUpKQJCUlIalISAEgSUkSBCkpCQqAlCQIKiQJCgRBUoKkJEEAIQlJCkhSgqSSJCgFKQBIUpASBEnSUEpSQYAkICmQpCQJKiQBCZKUIEApBCkACQGSBCRJSklSkgIpJEkACUIKJCVJQhAASZAKSEoCQhIEQZIEKQAEISlBCoKSJKWQBCRJkISABIlUSJIQJEkSKUlCglKCQJIUQJCSgBAkgJKUkCQBCZKUBClISkhJgoQkSUkSKQEkCQoCpIQkKUGSJJCUlIQUBCklSUJBUBIqSVKSlICglCQhCkhSKRCUpJCkBCmQhICUJCWpgpKQAkkgKUlBCgJQgJQgKRIkISQpgKSkJEgSBEFBkiQJkiQIkiQlKEECgiQBCUoQBEEQBIQEASRJCUmCkgQlSUESUoIEJUmSBCQJAEiCkKRAEJIECQBSApQgSEgCkoIkKUEAkiQpAEpSKkGSEJQkSAEpCYIEKUlIgCSQgJQQkCSEBAEIgBCkIAlIQkiCBKSCkKRAkiBBKUFISUAQSJIUBCWpIEBJgqRCEkiSpACkJKkglCApKUkqCEBKQJIUJCUISAEgQZIEBUKQJCUBSUEQJAQJSglSkAQAJEGSgpIkQQAkAQgIQoICAUoCkiTJKgQgSUoQBCQIEgBBUopIQgJSUoJUSFJACpJAkgIISEKSCkkCSAkCgJQkQQkgSRIUCFISBISEJAFJQYIUJCUgKUlKgCQFQQJICJIkSUKCoEAIBAlIkoKgICEISJAkkApBUoKSlCRIgqSSJCgoCQqCJCkBQEgqCEkKSYJSQJKUBICgJCgpSVIgSQhKkgQBUpIQSJIkQZIUSJKCJEFIKUGSkpIkSVJCSBJIkgQBCEoKUpCSBCkpJSBJEJAESYKUQJIECYKkhJAESQKSEJAkSJKSlCCoEICUklSSFAgpIEkSAgIkSQoEJAFKQVIqQQCkIIAgSUJKkCQJSgBJEkqCpJIkKQBSkiBIggQpSZKkJAgISQpIkgRJCSFBkgSBIEhJkJCQQJCUICBBKgkSQpKSkCRIkgAFAQhIEoKgICkkSZKAkIKgIKkgSFAKgiQgCUFJgiAlCYIEpRAkqQQFSUoSBIQEAUiCIAWSJEhQSpJASRIgSVJISkICUpCSgJRSEiRIUiBIgpAEICUJggSkBCBJkJQkpQIJAEpCCpJEkqQEJUhKQZIECZKkpCBIShJIgKSEoAQJSEFIgBQSJIUgqSSlAkHCSlACkpKkUJAkCCQJElKCoEKSJEhQQpKSEAQJSkoQJAQBCUJSApKQIEgIEiSoIEkCIJGSJElIkgApQZKkJEGQBEESFKAkKEFKgoKEJClIQYKgJCUIkhJASkhCQJKSoJCEkIQUBIQgCZCUAgFBkiBBUkpIUqQEkpQEQJKUIKkgSUmCBEEqSVAQBKSEJCUoSBIUpJRKgoKEIEhKgpASBIgkCUoKJCVISUgASUqClJSkQIIESUEKgpQESJKQJEhIQAkCUiAkKEkKKUmClCAICJIkQZKChCSlAAmCBKUEJSBJUlIKgqSkJKgUBAlBUpJCkBAEJSUIAkiSlKCkJCgBCEGSECSBpCRAQkASkJCUlCRIAkgSBKQQqSQJQEpBCoAkCUqQBIEESEmQIEkISiABKQUokCApCUJSSpCSgpASpABIAJAUQJAkBQGQAEmKBEgJQAlICpAQICmQJEkJApBUkKSUgKQCISQBCAFKgSQFJEgIQlKAhCSkkAQISgIqBEkKApASJCQJSEpCCpIkSJKCJEFICZJAkgISkpSUJEgSkhKkQJKEAkEBICglCAlSUoCQEpISBCEISlJSEpKgpCAkSSopCQhBUIBSEISUJKkkSZKCJCRBUEpIgqSSBCkhCQJCUkpIUpIUCEESJKSCgCSpACQJACQpICgkKQkCSgJISYIkCEJKgqAEKUkKQkgKQJCSkiQBQAIEpCAhBCkpCUkIgoKkJClBUpISBKQkQQmSlJJCSEJJSBIkSJAQKRAEIUmCkCQJUpCUJCkFSUFIIElISYIQJIQkIQkkJEhKkJKQJEhJkCRAKkmSkKQECZKkoAAoBSmQEiRIgoJSkgAlBZIUSJKCkBKkkgRAUgJCUpKkgKQEpSQJAhKQJAkkISBBEJIkSUkSCJKkQJKCkpCUICQlJUlSKpGUpJSUkISgBCkFJQhIkhSQJAQoSUFBCQlKCgIJCQgIkgQIgJRSEJKQJEgIKUAqSUpSEAQlQYIUCCFBUoISpCAoJSEFAZKkBEESBCkJClKSkJKCECRJSZKUpIJSQKqQkhQgKCUIQpIkBSklIEBSEKSCoKQEpCQBSUhJQJIkKQhAUpBCQgKQlCCQlKQEQpCSJCgoCEoCkpQgJQEJAkhSAqQgCAlSECRJggAJglKAQJKgAKQEISkpSZCSAkECkpSklCRASiBJKUiQIEgBSUqQkhSAlAokIQlKCkJKkpKEIEBSEiSlJKUkJUEpJCgpCUopKQWlIEESpCRIQEKSIAhSkARIEJCSICmQJEkBCFIIUpIKkiQBCUlCChKSJCEIQoIUCJIkQQIIUpJKUiBJAEKSoCBIQkpKgkBIkkACUoKAJEGCIJBSApJSSkhJQElSUpJIECAJSgJKkhCkkICAlCCQJCgJkiRBKklSkgQBQUpIkiABJEkIQkCSJAkISpISkpSkAEFJCSAoKUhKgIQgKUGQIEkCJElSUpIUpISkJElJkgBBkqSkkKRISlCSIEEgSZIUJKQEISAlCUJSkCRIgqQgSAmSIEFKkhSQIEgQBCkpSJKUkCRIkhSkEJAECUFSgpCUkARIECApSUlSEISkpEASpCRICpKUhJKCJCgkKQBJkhSklKSUIAVJkhQkIQlSQQgCUEopKUlSUpJKkgQgSZKkJIlEQkiSlKSQpISQJKUEAUEKAgQJSgKCUpIEQYKSgqQCBCFIkKQgBSkBQpKAJCUgCQhBSkqCpIAESJIUCEFSUkqSUpKkBElSCkBICZJICpKQpJKgJAkSAoIgCEFKkISUJKiQlKAUIAlIkgSlIAGSAgBSUpBUEKBUkICUIAhBkpCSIAUkgSSlJEmCkCSlBJASlCSQgiAJBCkJCEpKglJIgpIEQVKSpBQQoCQIKEFJUpIgICUJUpIUJCEIAiBJUkiSgIAEIQhJUpBCSoISJElSkIKSJCkhAQoCUkoSJEgSQBIkJQkgIQkpCUpSUkBISkFIkiRBiqQgBCkkSCkhJAhKSYKQJBSSlCQISZIAlIQCQUBIUpJKkJSQgCQkCcp/A/g3u6985fDDAAAAAElFTkSuQmCC">

    <title>WorkLog Pro 2026</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
</head>
<body>

    <header>
        <div id="total-surplus-val">--</div>
        <span class="label">BILANCIO TOTALE</span>
    </header>

    <main id="main-content">
        <section id="today-section" class="app-section">
            <div class="card compact-picker">
                <label>Giorno selezionato</label>
                <input type="date" id="current-date-picker" onchange="loadDay(this.value)">
            </div>
            
            <div class="card">
                <h3>Timbrate</h3>
                <div class="input-grid">
                    <div class="input-group"><label>Entrata</label><input type="time" id="time-in" onchange="calculateLogic()"></div>
                    <div class="input-group"><label>Uscita</label><input type="time" id="time-out" onchange="calculateLogic()"></div>
                    <div class="input-group"><label>Pausa In</label><input type="time" id="lunch-start" onchange="calculateLogic()"></div>
                    <div class="input-group"><label>Pausa Out</label><input type="time" id="lunch-end" onchange="calculateLogic()"></div>
                </div>
            </div>

            <div class="card result-card">
                <div class="stat-row"><span>Uscita Suggerita:</span><span id="suggested-exit" class="highlight">--:--</span></div>
                <div class="stat-row"><span>Fine turno tra:</span><span id="countdown-timer" class="highlight">--:--:--</span></div>
                <div class="stat-row mini-footer">
                    <span>Lavorate: <b id="daily-total">0h 0m</b></span>
                    <span>Surplus: <b id="daily-surplus">0h 0m</b></span>
                </div>
            </div>

            <div class="card">
                <h3>Stato & Range Periodo</h3>
                <select id="absence-type" onchange="toggleAbsenceFields()">
                    <option value="none">Lavorativa</option>
                    <option value="festivo">Festivo / Ferie</option>
                    <option value="sick">Malattia</option>
                    <option value="trip">Trasferta</option>
                    <option value="full-permit">Permesso Giornata</option>
                    <option value="partial-permit">Permesso Orario</option>
                </select>

                <div id="range-picker" style="margin-top:12px;">
                    <label>Applica periodo (Dal / Al):</label>
                    <div class="range-inputs">
                        <input type="date" id="range-start">
                        <input type="date" id="range-end">
                    </div>
                </div>

                <div id="partial-permit-input" style="display:none; margin-top:12px;">
                    <label>Orario Permesso (Da / A):</label>
                    <div class="range-inputs">
                        <input type="time" id="abs-start" onchange="calculateLogic()">
                        <input type="time" id="abs-end" onchange="calculateLogic()">
                    </div>
                </div>
            </div>

            <button class="save-btn" onclick="saveLogic()">SALVA REGISTRAZIONE</button>
        </section>

        <section id="history-section" class="app-section" style="display:none">
            <div class="card">
                <label>Filtra Mese</label>
                <input type="month" id="history-filter" onchange="renderHistory()">
            </div>
            <div id="history-list"></div>
        </section>

        <section id="analysis-section" class="app-section" style="display:none">
            <div class="card">
                <h3>Filtri Analisi</h3>
                <div class="input-grid">
                    <div class="input-group">
                        <label>Anno</label>
                        <select id="filter-year" onchange="renderAnalysis()"></select>
                    </div>
                    <div class="input-group">
                        <label>Mese</label>
                        <select id="filter-month" onchange="renderAnalysis()">
                            <option value="0">Gennaio</option><option value="1">Febbraio</option>
                            <option value="2">Marzo</option><option value="3">Aprile</option>
                            <option value="4">Maggio</option><option value="5">Giugno</option>
                            <option value="6">Luglio</option><option value="7">Agosto</option>
                            <option value="8">Settembre</option><option value="9">Ottobre</option>
                            <option value="10">Novembre</option><option value="11">Dicembre</option>
                        </select>
                    </div>
                </div>
                <div class="input-group" style="margin-top:10px;">
                    <label>Settimana (Scegli un giorno)</label>
                    <input type="date" id="filter-week-date" onchange="renderAnalysis()">
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="dash-card week-glow">
                    <span class="dash-label">SETTIMANA</span>
                    <div id="res-week" class="dash-val">0h 0m</div>
                    <small id="range-week" class="dash-range">--</small>
                </div>
                <div class="dash-card month-glow">
                    <span class="dash-label">MESE</span>
                    <div id="res-month" class="dash-val">0h 0m</div>
                    <small id="range-month" class="dash-range">--</small>
                </div>
                <div class="dash-card year-glow">
                    <span class="dash-label">ANNO</span>
                    <div id="res-year" class="dash-val">0h 0m</div>
                    <small id="range-year" class="dash-range">--</small>
                </div>
            </div>
        </section>

        <section id="settings-section" class="app-section" style="display:none">
            <div class="card">
                <h3>Backup & Dati</h3>
                <button class="action-btn" onclick="exportBackup()">SCARICA JSON</button>
                <button class="action-btn excel" onclick="exportToCSV()">ESPORTA EXCEL</button>
                <div style="margin-top:20px; border-top:1px solid #334155; padding-top:15px;">
                    <label>Carica Backup:</label>
                    <input type="file" id="import-file" onchange="importBackup(event)">
                </div>
            </div>
        </section>
    </main>

    <nav>
        <button onclick="showSection('today')" id="nav-today" class="active">Oggi</button>
        <button onclick="showSection('history')" id="nav-history">Storico</button>
        <button onclick="showSection('analysis')" id="nav-analysis">Analisi</button>
        <button onclick="showSection('settings')" id="nav-settings">Opzioni</button>
    </nav>

    <script src="script.js"></script>
</body>
</html>